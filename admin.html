<!DOCTYPE html>

<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Matheus Barber Shop</title>
    <link rel="icon" href="https://i.ibb.co/dwMYqmPk/IMG-2261.jpg">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #1a1a1a 0%, #000 100%); color: #fff; min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: rgba(0,0,0,0.5); padding: 20px; text-align: center; border-bottom: 2px solid #d4af37; margin-bottom: 30px; }
        .header-logo { max-width: 200px; height: auto; margin-bottom: 10px; }
        .admin-login { max-width: 400px; margin: 100px auto; background: #2a2a2a; padding: 40px; border-radius: 15px; border: 2px solid #d4af37; }
        .welcome { text-align: center; margin-bottom: 30px; }
        .welcome img { max-width: 180px; margin-bottom: 20px; }
        .welcome h2 { font-size: 32px; margin-bottom: 10px; }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; margin-bottom: 8px; font-weight: bold; }
        .form-input { width: 100%; padding: 15px; background: #1a1a1a; border: 2px solid #333; border-radius: 10px; color: #fff; font-size: 16px; }
        .btn { width: 100%; padding: 18px; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; margin-bottom: 15px; }
        .btn-primary { background: linear-gradient(135deg, #d4af37 0%, #b8860b 100%); color: #000; }
        .back-btn { padding: 12px; background: #2a2a2a; color: #fff; border: none; border-radius: 8px; cursor: pointer; }
        .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 10px; }
        .logout-btn { background: #dc3545; color: #fff; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: #2a2a2a; padding: 20px; border-radius: 10px; text-align: center; border: 2px solid #333; }
        .stat-number { font-size: 28px; font-weight: bold; color: #d4af37; margin-bottom: 5px; }
        .stat-label { color: #888; font-size: 13px; }
        .tabs { display: flex; gap: 8px; margin-bottom: 20px; overflow-x: auto; }
        .tab-btn { flex: 1; min-width: 70px; padding: 12px 6px; background: #2a2a2a; border: 2px solid #333; border-radius: 8px; cursor: pointer; font-weight: bold; color: #fff; font-size: 11px; }
        .tab-btn.active { background: #d4af37; color: #000; }
        .booking-card, .client-card { background: #2a2a2a; padding: 20px; border-radius: 10px; margin-bottom: 15px; border: 2px solid #333; }
        .action-btn { padding: 10px 8px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 11px; margin: 5px; min-width: 70px; }
        .btn-confirm { background: #007bff; color: #fff; }
        .btn-complete { background: #28a745; color: #fff; }
        .btn-cancel { background: #dc3545; color: #fff; }
        .btn-block { background: #e74c3c; color: #fff; }
        .btn-unblock { background: #2ecc71; color: #fff; }
        .btn-paid { background: #2ecc71; color: #fff; }
        .status-badge { padding: 5px 10px; border-radius: 5px; font-size: 11px; font-weight: bold; margin: 5px 5px 0 0; display: inline-block; }
        .status-pending { background: #ffc107; color: #000; }
        .status-confirmed { background: #007bff; color: #fff; }
        .status-completed { background: #28a745; color: #fff; }
        .status-cancelled { background: #dc3545; color: #fff; }
        .status-paid { background: #2ecc71; color: #fff; }
        .status-unpaid { background: #e67e22; color: #fff; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 15px; background: #2a2a2a; border-radius: 10px; }
        .calendar-nav-btn { padding: 10px 15px; background: #d4af37; color: #000; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; }
        .calendar-title { font-size: 18px; font-weight: bold; color: #d4af37; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-bottom: 20px; }
        .calendar-day-header { text-align: center; padding: 10px; background: #2a2a2a; border-radius: 5px; font-size: 11px; font-weight: bold; color: #d4af37; }
        .calendar-day { background: #2a2a2a; border: 2px solid #333; border-radius: 10px; padding: 8px; min-height: 100px; cursor: pointer; }
        .calendar-day:hover { border-color: #d4af37; }
        .calendar-day.today { border-color: #d4af37; background: #333; }
        .calendar-day.other-month { opacity: 0.3; }
        .calendar-day-number { font-weight: bold; font-size: 14px; margin-bottom: 5px; }
        .calendar-booking { background: #007bff; padding: 2px 4px; border-radius: 4px; font-size: 9px; margin-bottom: 2px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .calendar-booking.completed { background: #28a745; }
        .calendar-booking.cancelled { background: #dc3545; }
        .calendar-booking.blocked { background: #e74c3c; }
        .calendar-booking.unpaid { background: #e67e22; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; overflow-y: auto; }
        .modal.active { display: flex; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: #1a1a1a; padding: 25px; border-radius: 15px; max-width: 500px; width: 100%; border: 2px solid #d4af37; margin: 20px; max-height: 85vh; overflow-y: auto; }
        .modal-title { font-size: 20px; margin-bottom: 20px; color: #d4af37; }
        .modal-close { float: right; font-size: 28px; cursor: pointer; color: #888; line-height: 20px; }
        .modal-close:hover { color: #fff; }
        .settings-section { margin-bottom: 25px; }
        .settings-title { font-size: 16px; color: #d4af37; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
    </style>
</head>
<body>
    <div class="header">
        <img src="https://i.ibb.co/dwMYqmPk/IMG-2261.jpg" class="header-logo">
        <p style="color:#888;font-size:14px;">Painel Administrativo</p>
    </div>
    <div class="container" id="main-container"></div>
    <div id="modal" class="modal"></div>

```
<script>
    const ADMIN_PASSWORD = 'matheus123';
    let isAdminLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
    let currentTab = 'calendar';
    let currentCalendarDate = new Date();

    function getBookings() { return JSON.parse(localStorage.getItem('bookings') || '[]'); }
    function saveBookings(b) { localStorage.setItem('bookings', JSON.stringify(b)); }
    function getBlockedTimes() { return JSON.parse(localStorage.getItem('blockedTimes') || '[]'); }
    function saveBlockedTimes(times) { localStorage.setItem('blockedTimes', JSON.stringify(times)); }
    function getBlockedClients() { return JSON.parse(localStorage.getItem('blockedClients') || '[]'); }
    function saveBlockedClients(clients) { localStorage.setItem('blockedClients', JSON.stringify(clients)); }
    
    function updateBooking(id, u) { 
        const b = getBookings(); 
        const i = b.findIndex(x => x.id === id); 
        if (i !== -1) { 
            b[i] = {...b[i], ...u}; 
            saveBookings(b); 
        }
    }
    
    function deleteBooking(id) { saveBookings(getBookings().filter(b => b.id !== id)); }

    function blockTimeSlot(date, time) {
        const blocked = getBlockedTimes();
        const dateStr = date.split('T')[0];
        const blockId = `${dateStr}_${time}`;
        if (!blocked.find(b => b.id === blockId)) {
            blocked.push({ id: blockId, date: dateStr, time: time });
            saveBlockedTimes(blocked);
        }
    }

    function unblockTimeSlot(blockId) {
        saveBlockedTimes(getBlockedTimes().filter(b => b.id !== blockId));
    }

    function blockClient(phone, name) {
        const blocked = getBlockedClients();
        if (!blocked.find(c => c.phone === phone)) {
            blocked.push({ phone, name, blockedAt: new Date().toISOString() });
            saveBlockedClients(blocked);
        }
    }

    function unblockClient(phone) {
        saveBlockedClients(getBlockedClients().filter(c => c.phone !== phone));
    }

    function isClientBlocked(phone) {
        return getBlockedClients().some(c => c.phone === phone);
    }

    function getAllClients() {
        const bookings = getBookings();
        const clientsMap = new Map();
        bookings.forEach(booking => {
            const phone = booking.customer.phone;
            if (!clientsMap.has(phone)) {
                clientsMap.set(phone, { 
                    name: booking.customer.name, 
                    phone: booking.customer.phone, 
                    email: booking.customer.email || '', 
                    totalBookings: 0, 
                    totalSpent: 0, 
                    lastVisit: booking.date,
                    blocked: isClientBlocked(phone)
                });
            }
            const client = clientsMap.get(phone);
            client.totalBookings++;
            if (booking.status === 'completed' && booking.paid) client.totalSpent += booking.service.price;
            if (new Date(booking.date) > new Date(client.lastVisit)) client.lastVisit = booking.date;
        });
        return Array.from(clientsMap.values());
    }

    function loginAdmin() {
        if (document.getElementById('admin-password').value === ADMIN_PASSWORD) {
            isAdminLoggedIn = true;
            localStorage.setItem('adminLoggedIn', 'true');
            render();
        } else alert('Senha incorreta!');
    }

    function logoutAdmin() {
        isAdminLoggedIn = false;
        localStorage.removeItem('adminLoggedIn');
        render();
    }

    function renderAdminLogin() {
        document.getElementById('main-container').innerHTML = `
            <div class="admin-login">
                <div class="welcome">
                    <img src="https://i.ibb.co/dwMYqmPk/IMG-2261.jpg">
                    <h2>Acesso Admin</h2>
                    <p style="color:#888;">Digite a senha</p>
                </div>
                <div class="form-group">
                    <label class="form-label">Senha</label>
                    <input type="password" id="admin-password" class="form-input">
                </div>
                <button class="btn btn-primary" onclick="loginAdmin()">Entrar</button>
                <button class="btn back-btn" onclick="location.href='index.html'" style="width:100%;">‚Üê Voltar</button>
            </div>`;
    }

    function showTab(tab) { currentTab = tab; renderAdminPanel(); }

    function renderAdminPanel() {
        const bookings = getBookings();
        const clients = getAllClients();
        const today = new Date().toDateString();
        const todayB = bookings.filter(b => new Date(b.date).toDateString() === today);
        const completed = bookings.filter(b => b.status === 'completed').length;
        const paidBookings = bookings.filter(b => b.paid);
        const revenue = paidBookings.reduce((sum, b) => sum + b.service.price, 0);
        const blockedCount = getBlockedClients().length;

        document.getElementById('main-container').innerHTML = `
            <div class="admin-header"><h2>Painel Admin</h2><button class="logout-btn" onclick="logoutAdmin()">Sair</button></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-number">${bookings.length}</div><div class="stat-label">Total</div></div>
                <div class="stat-card"><div class="stat-number">${todayB.length}</div><div class="stat-label">Hoje</div></div>
                <div class="stat-card"><div class="stat-number">${completed}</div><div class="stat-label">Atendidos</div></div>
                <div class="stat-card"><div class="stat-number">${paidBookings.length}</div><div class="stat-label">Pagos</div></div>
                <div class="stat-card"><div class="stat-number">R$ ${revenue}</div><div class="stat-label">Recebido</div></div>
                <div class="stat-card"><div class="stat-number">${blockedCount}</div><div class="stat-label">Bloqueados</div></div>
            </div>
            <div class="tabs">
                <button class="tab-btn ${currentTab === 'calendar' ? 'active' : ''}" onclick="showTab('calendar')">üìÖ Calend√°rio</button>
                <button class="tab-btn ${currentTab === 'bookings' ? 'active' : ''}" onclick="showTab('bookings')">üìã Lista</button>
                <button class="tab-btn ${currentTab === 'clients' ? 'active' : ''}" onclick="showTab('clients')">üë• Clientes</button>
                <button class="tab-btn ${currentTab === 'blocked' ? 'active' : ''}" onclick="showTab('blocked')">üö´ Bloqueados</button>
            </div>
            <div id="admin-content"></div>`;

        if (currentTab === 'calendar') renderCalendar();
        else if (currentTab === 'bookings') renderBookingsList();
        else if (currentTab === 'clients') renderClientsList();
        else renderBlockedList();
    }

    function renderCalendar() {
        const year = currentCalendarDate.getFullYear();
        const month = currentCalendarDate.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const today = new Date();
        
        const monthNames = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
        const dayNames = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];

        let html = `
            <div class="calendar-header">
                <button class="calendar-nav-btn" onclick="previousMonth()">‚óÄ Ant</button>
                <div class="calendar-title">${monthNames[month]} ${year}</div>
                <button class="calendar-nav-btn" onclick="nextMonth()">Prox ‚ñ∂</button>
            </div>
            <div class="calendar-grid">`;

        dayNames.forEach(day => html += `<div class="calendar-day-header">${day}</div>`);

        const startDay = firstDay.getDay();
        for (let i = 0; i < startDay; i++) {
            const prevDay = new Date(year, month, 0 - (startDay - i - 1));
            html += `<div class="calendar-day other-month"><div class="calendar-day-number">${prevDay.getDate()}</div></div>`;
        }

        for (let day = 1; day <= lastDay.getDate(); day++) {
            const currentDate = new Date(year, month, day);
            const dateStr = currentDate.toISOString().split('T')[0];
            const isToday = currentDate.toDateString() === today.toDateString();
            
            const dayBookings = getBookings().filter(b => b.date.split('T')[0] === dateStr);
            const blockedTimes = getBlockedTimes().filter(b => b.date === dateStr);
            
            html += `<div class="calendar-day ${isToday ? 'today' : ''}" onclick="showDayDetails('${dateStr}')">
                <div class="calendar-day-number">${day}</div>`;
            
            dayBookings.slice(0, 2).forEach(b => {
                const statusClass = b.paid ? 'completed' : (b.paid === false ? 'unpaid' : b.status);
                html += `<div class="calendar-booking ${statusClass}">${b.time} ${b.customer.name.split(' ')[0]}</div>`;
            });
            
            if (dayBookings.length > 2) html += `<div style="font-size:9px;color:#888;">+${dayBookings.length - 2}</div>`;
            if (blockedTimes.length > 0) html += `<div class="calendar-booking blocked">üö´ ${blockedTimes.length}</div>`;
            
            html += `</div>`;
        }

        const endDay = lastDay.getDay();
        for (let i = endDay + 1; i < 7; i++) {
            html += `<div class="calendar-day other-month"><div class="calendar-day-number">${i - endDay}</div></div>`;
        }

        html += `</div>`;
        document.getElementById('admin-content').innerHTML = html;
    }

    function previousMonth() {
        currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
        renderCalendar();
    }

    function nextMonth() {
        currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
        renderCalendar();
    }

    function showDayDetails(dateStr) {
        const date = new Date(dateStr + 'T12:00:00');
        const bookings = getBookings().filter(b => b.date.split('T')[0] === dateStr);
        const blockedTimes = getBlockedTimes().filter(b => b.date === dateStr);
        const timeSlots = ['09:00','09:30','10:00','10:30','11:00','11:30','14:00','14:30','15:00','15:30','16:00','16:30','17:00','17:30','18:00','18:30','19:00','19:30'];
        
        let html = `<div class="modal-content"><span class="modal-close" onclick="closeModal()">&times;</span><h2 class="modal-title">üìÖ ${date.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' })}</h2>`;
        
        if (bookings.length > 0) {
            html += `<div class="settings-section"><h3 class="settings-title">Agendamentos</h3>`;
            bookings.forEach(b => {
                html += `<div class="booking-card" style="padding:15px;margin-bottom:10px;">
                    <div><strong>${b.time}</strong> - ${b.customer.name}</div>
                    <div style="font-size:12px;color:#888;">${b.service.name} | R$ ${b.service.price}</div>
                    <div style="font-size:12px;color:#25d366;">üì± ${b.customer.phone}</div>
                    <span class="status-badge status-${b.status}">${{pending:'Pendente',confirmed:'Confirmado',completed:'Conclu√≠do',cancelled:'Cancelado'}[b.status]}</span>
                    <span class="status-badge ${b.paid ? 'status-paid' : 'status-unpaid'}">${b.paid ? '‚úì Pago' : '‚úó N√£o Pago'}</span>
                </div>`;
            });
            html += `</div>`;
        }
        
        html += `<div class="settings-section"><h3 class="settings-title">üö´ Gerenciar Hor√°rios</h3>`;
        timeSlots.forEach(time => {
            const blockId = `${dateStr}_${time}`;
            const isBlocked = blockedTimes.find(b => b.id === blockId);
            const hasBooking = bookings.find(b => b.time === time);
            
            if (isBlocked) {
                html += `<button class="btn btn-primary" style="margin-bottom:8px;background:#28a745;padding:10px;" onclick="unblockTime('${blockId}')">${time} ‚úì Bloqueado</button>`;
            } else if (hasBooking) {
                html += `<button class="btn" style="margin-bottom:8px;background:#555;cursor:not-allowed;padding:10px;" disabled>${time} Ocupado</button>`;
            } else {
                html += `<button class="btn btn-cancel" style="margin-bottom:8px;padding:10px;" onclick="blockTime('${dateStr}', '${time}')">${time} Bloquear</button>`;
            }
        });
        html += `</div></div>`;
        
        document.getElementById('modal').innerHTML = html;
        document.getElementById('modal').classList.add('active');
    }

    function blockTime(date, time) {
        blockTimeSlot(date, time);
        closeModal();
        render();
        alert(`‚úÖ ${time} bloqueado!`);
    }

    function unblockTime(blockId) {
        unblockTimeSlot(blockId);
        closeModal();
        render();
        alert('‚úÖ Hor√°rio desbloqueado!');
    }

    function renderBlockedList() {
        const blockedClients = getBlockedClients();
        const blockedTimes = getBlockedTimes();
        
        let html = `<div class="settings-section"><h3 class="settings-title">üö´ Clientes Bloqueados (${blockedClients.length})</h3>`;
        html += blockedClients.length === 0 ? '<p style="text-align:center;color:#888;padding:20px;">Nenhum cliente bloqueado</p>' : 
            blockedClients.map(c => `
                <div class="client-card" style="padding:15px;">
                    <div><strong>üë§ ${c.name}</strong></div>
                    <div style="color:#25d366;font-size:14px;">üì± ${c.phone}</div>
                    <div style="color:#888;font-size:12px;">Bloqueado: ${new Date(c.blockedAt).toLocaleDateString('pt-BR')}</div>
                    <button class="btn btn-unblock" style="margin-top:10px;padding:10px;" onclick="unblockClientAction('${c.phone}')">Desbloquear</button>
                </div>
            `).join('');
        
        html += `</div><div class="settings-section"><h3 class="settings-title">üö´ Hor√°rios Bloqueados (${blockedTimes.length})</h3>`;
        html += blockedTimes.length === 0 ? '<p style="text-align:center;color:#888;padding:20px;">Nenhum hor√°rio bloqueado</p>' : 
            blockedTimes.sort((a,b) => new Date(a.date) - new Date(b.date)).map(t => `
                <div class="booking-card" style="padding:15px;">
                    <div><strong>üìÖ ${new Date(t.date + 'T12:00:00').toLocaleDateString('pt-BR')}</strong></div>
                    <div style="color:#888;">üïê ${t.time}</div>
                    <button class="btn btn-unblock" style="margin-top:10px;padding:10px;" onclick="unblockTime('${t.id}')">Desbloquear</button>
                </div>
            `).join('');
        html += `</div>`;
        document.getElementById('admin-content').innerHTML = html;
    }

    function unblockClientAction(phone) {
        if (confirm('Desbloquear este cliente?')) {
            unblockClient(phone);
            render();
            alert('‚úÖ Cliente desbloqueado!');
        }
    }

    function renderBookingsList() {
        const bookings = getBookings().sort((a, b) => new Date(b.date) - new Date(a.date));
        let html = bookings.length === 0 ? '<p style="text-align:center;color:#888;padding:40px">Nenhum agendamento</p>' : bookings.map(b => `
            <div class="booking-card">
                <div><strong>${b.customer.name}</strong></div>
                <div style="color:#25d366;font-size:14px;">üì± ${b.customer.phone}</div>
                ${b.customer.email ? `<div style="color:#888;font-size:14px;">üìß ${b.customer.email}</div>` : ''}
                <div style="margin-top:8px;">
                    <span class="status-badge status-${b.status}">${{pending:'Pendente',confirmed:'Confirmado',completed:'Conclu√≠do',cancelled:'Cancelado'}[b.status]}</span>
                    <span class="status-badge ${b.paid ? 'status-paid' : 'status-unpaid'}">${b.paid ? '‚úì Pago' : '‚úó N√£o Pago'}</span>
                </div>
                <div style="margin-top:10px;">
                    <div>üíà ${b.service.name} | üí∞ R$ ${b.service.price}</div>
                    <div style="color:#888;font-size:14px;margin-top:5px;">üìÖ ${new Date(b.date).toLocaleDateString('pt-BR')} | üïê ${b.time}</div>
                </div>
                <div style="display:flex;gap:8px;margin-top:15px;flex-wrap:wrap;">
                    ${!b.paid ? `<button class="action-btn btn-paid" onclick="markAsPaid('${b.id}')">üí∞ Pago</button>` : ''}
                    <button class="action-btn btn-confirm" onclick="updateBooking('${b.id}', {status:'confirmed'}); render()">Confirmar</button>
                    <button class="action-btn btn-complete" onclick="updateBooking('${b.id}', {status:'completed'}); render()">Conclu√≠do</button>
                    <button class="action-btn btn-cancel" onclick="if(confirm('Cancelar?')) { deleteBooking('${b.id}'); render(); }">Cancelar</button>
                    <button class="action-btn btn-block" onclick="blockClientAction('${b.customer.phone}', '${b.customer.name}')">Bloquear</button>
                </div>
            </div>`).join('');
        document.getElementById('admin-content').innerHTML = html;
    }

    function markAsPaid(id) {
        updateBooking(id, { paid: true });
        render();
        alert('‚úÖ Marcado como pago!');
    }

    function blockClientAction(phone, name) {
        if (confirm(`Bloquear ${name}?`)) {
            blockClient(phone, name);
            render();
            alert('‚úÖ Cliente bloqueado!');
        }
    }

    function renderClientsList() {
        const clients = getAllClients().sort((a, b) => b.totalBookings - a.totalBookings);
        let html = clients.length === 0 ? '<p style="text-align:center;
```